<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Página de Tarefas - InvestSmart</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Estilo para Toast e animações -->
  <style>
    .toast {
      visibility: hidden;
      min-width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 2px;
      padding: 16px;
      position: fixed;
      z-index: 1;
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
    }

    .toast.show {
      visibility: visible;
      animation: fadeIn 0.5s, fadeOut 0.5s 2.5s;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">

  <!-- HEADER -->
  <header class="bg-black text-white py-4 sticky top-0 shadow-md z-50">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
      <h1 class="text-xl font-bold">InvestSmart</h1>
    </div>
  </header>

  <!-- SEÇÃO PRINCIPAL -->
  <section class="bg-red-500 text-white p-10 rounded-b-3xl">
    <div class="flex flex-col items-center">
      <div class="w-32 h-32 bg-white rounded-full flex justify-center items-center mb-6">
        <img src="https://www.caixaangola.ao/storage/media/143/cartao-03-hero.png" alt="Logo InvestSmart" class="w-16 h-16">
      </div>
      <h2 class="text-3xl font-bold mb-4">Bem-vindo ao InvestSmart!</h2>
      <p class="text-lg mb-6">Gerencie seus convites de investimento de forma simples e eficiente.</p>
      <button id="startBtn" class="bg-blue-500 text-white px-6 py-3 rounded hover:bg-blue-600 transition">
        Iniciar convidando
      </button>

     <!-- Cartão com código -->
<div class="mt-6 bg-white p-8 rounded-lg shadow-lg w-full max-w-xs text-center">
  <!-- Título -->
  <h4 class="text-2xl font-semibold text-gray-800 mb-6">
    Código de Convite
  </h4>

  <!-- Descrição do convite -->
  <p id="codigoConvite" class="text-lg text-gray-600 mb-6">
    Carregando...
  </p>

  <!-- Link de convite -->
  <div class="mb-6">
    <a href="#" id="invite-link" class="text-blue-500 font-semibold text-lg hover:text-blue-600">
      
    </a>
  </div>

 <!-- Cartão com código -->
<div class="mt-6 bg-white p-8 rounded-lg shadow-lg w-full max-w-xs text-center">
  <!-- Título -->
  <h4 class="text-2xl font-semibold text-gray-800 mb-6">
    
  </h4>

  <!-- Descrição do convite -->
  <p id="codigoConvite" class="text-lg text-gray-600 mb-6">
    
  </p>

  <!-- Link de convite -->
  <div class="mb-6">
    <a href="#" id="invite-link" class="text-blue-500 font-semibold text-lg hover:text-blue-600">
      
    </a>
  </div>

  <!-- Botão para copiar o código -->
  <button id="copiarCodigoBtn" class="w-full bg-yellow-500 text-white py-3 px-4 rounded-lg shadow-lg hover:bg-yellow-600 transition duration-300 flex items-center justify-center text-lg">
    <span class="mr-2">Copiar Link</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 17l4 4m0 0l-4 4m4-4H7a4 4 0 1 1 0-8h8m-4 4l-4-4m4 4H7" />
    </svg>
  </button>
</div>

  </section>

 <!-- CONTEÚDO PRINCIPAL -->
<section class="max-w-7xl mx-auto px-4 mt-10">
  <!-- Cartão com texto informativo -->
  <div class="bg-white p-8 rounded-lg shadow-lg mb-8">
    <h3 class="text-2xl font-bold text-center text-gray-800 mb-6">
      Convide agora e ganhe recompensas exclusivas!
    </h3>
    <p class="text-lg text-center text-gray-600 mb-6">
      Convide seus amigos e conquiste as seguintes recompensas:
    </p>
    
    <!-- Recompensas -->
    <div class="flex justify-center space-x-6 mb-6">
      <div class="bg-yellow-100 text-yellow-800 px-4 py-2 rounded-lg shadow-md text-lg font-semibold">
        Nível 1: 27%
      </div>
      <div class="bg-green-100 text-green-800 px-4 py-2 rounded-lg shadow-md text-lg font-semibold">
        Nível 2: 2%
      </div>
      <div class="bg-blue-100 text-blue-800 px-4 py-2 rounded-lg shadow-md text-lg font-semibold">
        Nível 3: 1%
      </div>
    </div>
    
    <!-- Chamada para ação -->
    <p class="text-xl font-semibold text-center text-gray-800">
      Comece agora e aproveite essas vantagens!
    </p>
    
    <!-- Contagem regressiva -->
    <div class="text-3xl font-mono text-center mt-4 text-gray-700" id="countdown">
      Tempo para aproveitar as recompensas: 350 Dias restante
    </div>
  </div>
</section>


    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
      <!-- Saldo do Usuário -->
      <div class="bg-white p-6 rounded shadow-lg">
        <h4 class="text-xl font-semibold mb-4">Saldo total</h4>
        <p id="saldo-usuario" class="text-gray-600 text-2xl font-bold">Carregando...</p>
      </div>

      <!-- Saldo Investido -->
      <div class="bg-white p-6 rounded shadow-lg">
        <h4 class="text-xl font-semibold mb-4">Convidados N1, N2, N3</h4>
        <p id="saldo-investido" class="text-gray-600 text-2xl font-bold">Carregando...</p>
      </div>


<!-- Renda Total com botão de copiar -->
<div class="bg-white p-6 rounded shadow-lg flex items-center space-x-4">
  <!-- Botão circular amarelo -->
  <button
    id="copiarLinkConvite"
    class="bg-yellow-400 hover:bg-yellow-500 text-white w-10 h-10 rounded-full flex items-center justify-center shadow-md transition"
    title="Copiar link"
  >
    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8 16h8M8 12h8m-8-4h8M5 20h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z"/>
    </svg>
  </button>
  <!-- Conteúdo do cartão -->
  <div>
    <h4 class="text-xl font-semibold mb-2">Link para convidar</h4>
    <p id="renda-total" class="text-gray-600 text-lg font-bold break-words">Carregando...</p>
  </div>
</div>



    </div>
  </section>

  <!-- NAVIGATION (MOBILE) -->
  <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-300 shadow-inner z-50 md:hidden">
    <div class="flex justify-around items-center py-2 text-gray-600">
      <a href="home.html" class="flex flex-col items-center text-sm hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M3 9l9-6 9 6v10.5A1.5 1.5 0 0 1 19.5 21h-15A1.5 1.5 0 0 1 3 19.5V9z" />
        </svg>
        Início
      </a>
      <a href="investir.html" class="flex flex-col items-center text-sm hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8v1m0 7v1m-9-5a9 9 0 1 1 18 0 9 9 0 0 1-18 0z" />
        </svg>
        Investir
      </a>
      <a href="tarefas.html" class="flex flex-col items-center text-sm hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M3 7h18M3 11h18M3 15h18M3 19h18" />
        </svg>
        Equipe
      </a>
      <a href="perfil.html" class="flex flex-col items-center text-sm hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
            d="M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0zM4.5 20.25a8.25 8.25 0 0 1 15 0" />
        </svg>
        Perfil
      </a>
    </div>
  </nav>

  <!-- FOOTER -->
  <footer class="bg-gray-900 text-gray-300 py-6 mt-16">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <p>&copy; 2025 InvestSmart. Todos os direitos reservados.</p>
    </div>
  </footer>

  <!-- TOAST -->
  <div id="toast" class="toast">Link de convite copiado com sucesso!</div>

  <!-- ... seu código HTML anterior permanece igual ... -->

<script>
  window.onload = function () {
    const userData = JSON.parse(localStorage.getItem('user_data'));

    if (userData) {
      // Exibe saldo
      document.getElementById('saldo-usuario').textContent = `Kz ${parseFloat(userData.saldo || 0).toFixed(2)}`;

      // Exibe telefone no "Link para convidar"
      document.getElementById('renda-total').textContent = ` ${userData.codigo_convite || 'N/A'}`;

      // Código de convite
      document.getElementById('codigoConvite').textContent = userData.codigo_convite || 'N/A';
      const inviteLink = `file:///C:/Users/us/Desktop/Agrimetch/registrar.html?codigo_convite=${userData.codigo_convite}`;
      document.getElementById('invite-link').href = inviteLink;

      // Buscar usuários para filtrar convidados
      fetch('https://meuappi.onrender.com/usuarios')
        .then(response => response.json())
        .then(usuarios => {
          // Filtra usuários que foram convidados por este usuário logado
          const convidados = usuarios.filter(u => u.codigo_convite_referido === userData.codigo_convite);
          const total = convidados.length;

          // Formata telefones com ocultação dos 3 dígitos do meio
          const listaConvidados = convidados.map(c => {
            const tel = c.telefone;
            if (tel.length === 9) {
              const masked = tel.substring(0, 3) + '***' + tel.substring(6);
              return `<li>+244 ${masked}</li>`;
            }
            return `<li>+244 ${tel}</li>`;
          }).join('');

          // Exibe no cartão "Convidados N1"
          const convidadosN1El = document.getElementById('saldo-investido');
          convidadosN1El.innerHTML = `
            <div>Total: <strong>${total}</strong></div>
            <ul class="mt-2 text-sm space-y-1 list-none">${listaConvidados || '<li>Nenhum convidado ainda.</li>'}</ul>
          `;
        })
        .catch(err => {
          console.error('Erro ao buscar usuários:', err);
          document.getElementById('saldo-investido').textContent = 'Erro ao carregar convidados';
        });
    }

    // Copiar link do convite
    document.getElementById('copiarCodigoBtn').addEventListener('click', function () {
      const inviteLink = document.getElementById('invite-link').href;
      const textarea = document.createElement('textarea');
      textarea.value = inviteLink;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);

      const toast = document.getElementById('toast');
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    });
  };

  // Copiar link do convite (botão bolinha amarelo)
document.getElementById('copiarLinkConvite').addEventListener('click', function () {
  const inviteLink = document.getElementById('invite-link').href;
  const textarea = document.createElement('textarea');
  textarea.value = inviteLink;
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand('copy');
  document.body.removeChild(textarea);

  const toast = document.getElementById('toast');
  toast.textContent = 'Link de convite copiado com sucesso!';
  toast.classList.add('show');
  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
});

</script>
